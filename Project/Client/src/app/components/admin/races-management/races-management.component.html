<div class="padded-content">
    <mat-card class="compact-card scroll">

        <p>Manage races</p>
        <div class="spinner-container" *ngIf="loading">
            <mat-spinner [diameter]="70"></mat-spinner>
        </div>

        <!-- line selection -->
        <mat-form-field class="races-selection">
            <mat-label>Line</mat-label>
            <mat-select [(value)]="lineSelected">
                <mat-option *ngFor="let line of lines" [value]="line">
                    {{line.name}}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <!-- Way selection -->
        <mat-form-field class="races-selection">
            <mat-label>Direction</mat-label>
            <mat-select [(value)]="directionSelected">
                <mat-option *ngFor="let dir of directions" [value]="dir">
                    {{dir.text}}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <!-- From Date selection -->
        <mat-form-field class="races-selection">
            <mat-label>From Date</mat-label>
            <input matInput [matDatepicker]="pickerFrom" [(ngModel)]="fromDateSelected" disabled>
            <mat-datepicker-toggle matSuffix [for]="pickerFrom"></mat-datepicker-toggle>
            <mat-datepicker #pickerFrom disabled="false" [startAt]="fromDateSelected"></mat-datepicker>
        </mat-form-field>

        <!-- To Date selection -->
        <mat-form-field class="races-selection">
            <mat-label>To Date</mat-label>
            <input matInput [matDatepicker]="pickerTo" [(ngModel)]="toDateSelected" disabled>
            <mat-datepicker-toggle matSuffix [for]="pickerTo"></mat-datepicker-toggle>
            <mat-datepicker #pickerTo disabled="false" [startAt]="toDateSelected"></mat-datepicker>
        </mat-form-field>

        <button mat-raised-button [disabled]="lineSelected==null || directionSelected==null" (click)="search()">Search</button>

        <mat-table [dataSource]="dataSource">

            <!-- LineName Column -->
            <ng-container matColumnDef="LineName">
                <th mat-header-cell *matHeaderCellDef> LineName </th>
                <td mat-cell *matCellDef="let element"> {{element.lineName}} </td>
            </ng-container>

            <!-- Direction Column -->
            <ng-container matColumnDef="Direction">
                <th mat-header-cell *matHeaderCellDef> Direction </th>
                <td mat-cell *matCellDef="let element"> {{element.direction}} </td>
            </ng-container>

            <!-- Date Column -->
            <ng-container matColumnDef="Date">
                <th mat-header-cell *matHeaderCellDef> Date </th>
                <td mat-cell *matCellDef="let element"> {{element.date.toDateString()}} </td>
            </ng-container>

            <!-- Passengers Column -->
            <ng-container matColumnDef="Passengers">
                <th class="center-vertical" mat-header-cell *matHeaderCellDef> Passengers </th>
                <td mat-cell class="center-vertical" *matCellDef="let element"> {{element.passengers.length}} </td>
            </ng-container>

            <!-- Companions Column -->
            <ng-container matColumnDef="Companions">
                <th class="squeeze center-vertical" mat-header-cell *matHeaderCellDef> Companions </th>
                <td mat-cell class="squeeze center-vertical" *matCellDef="let element"> {{element.companions.length}} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="getDisplayedColumns()"></tr>
            <tr mat-row *matRowDef="let row; columns: getDisplayedColumns()" [ngClass]="{ 'mobile': isMobile}" (click)="viewRace(row)"></tr>
        </mat-table>
    </mat-card>
</div>